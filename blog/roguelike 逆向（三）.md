准确来说已经不是同一个游戏了，但是依旧是同一个作者的游戏

## 写在前头

存档的十六进制结构我已经研究过了，每个人的背包都是独立的，解锁新角色后会写新的段进去，每个人的操作重点也都不一致，所以先那萨夏来改，因为萨夏清杂速度快

因为存档会因为物品的增多而不断延长，人物也特别多，还没现成资料没法解密存档。所以我已经不指望和前作一样专门去修改十六进制存档了，虽然前作的十六进制修改简直是地狱，不过好歹也完成了目标

唯一的好事是代码地址和前作一样，不是随机分配的，所以这次将重点放在研究代码上面
![[Pasted image 20240710230325.png]]
上图这是游戏过程中收集的代码片段，涉及到了绝大多数游戏相关的内容

再叠一层甲：本篇倾向于经验谈，有的东西这里不讨论，我只是想通关

## 游戏基本设置

我用不惯默认的那套，改了

上下左右：wasd
菜单：l
确认：j
取消：k
	
## 等级

一开始我以为地下室是用来传送的，结果随着游戏进程的推进，地下室逐渐被牌子堆满了......我一直在想为什么，直到我解锁了角色。原来地下室是供所有角色快速解锁等级上限和游戏系统的，这个还是好评的，每个角色都跑一次，打一次听起来就绝望

游戏解锁时空交错的时候就说了：每个角色的物品、经验、经历都是独立的，之后真解锁的时候，我去看存档，发现游戏默认存档真的只有一个角色，然后新角色的背包什么的会一直 append 到最后面......

对付这个，我的方式就是挂 CE，然后改完保存

这里和前作不一样，等级是不可直接修改的，取而代之的是修改经验值。前作为了在混乱效果状态下乱序显示等级条，等级也是有一个专门的寄存器的
修改经验值的方式倒也简单：家门口解锁了供奉经验的石头后就可以很直观地看到自己一共有多少经验了，扫一次，交一次，再扫一次就出来了，是一个 4byte

除此之外经验满了再杀怪也是保留的，随着游戏进程的推进，碑开的上限到多少，等级就多少，不必担忧
## 控制效果自动解除

最简单最暴力的就是把 dec 改成 inc 就行，就是个寄存器而已
![[Pasted image 20240710231406.png]]
*game.exe+F7A47*

## 血量
因为众所周知的原因，玩家和怪物共享一个类，而角色血量的地址每次都会变，所以写脚本要比较玩家所属的阵营

类里面一般是没用指针的，把类指针改成 4byte 就可以了，在此不再赘述

## MP
这一作的敌人有个架势条，和主角的 mp条似乎是共享的，与只狼不同，架势条爆条了就只会晕一阵子

我喜欢玩卡牌就是因为她爆条特别快还带 AOE，对于只能左右射击的这作来说特别重要

## 小 bug

角色直着撞到墙会停，斜着撞到墙可以保持左右移动，如果撞到墙时，身子一大半在墙外面又无法通过的话......角色就会鬼畜地顶墙疾跑